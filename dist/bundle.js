!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.active=!1,this.type=0,this.position=e};t.Entity=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.makeMatFromTexture=function(e,t,i){var n=new BABYLON.StandardMaterial("mat_"+(this.materials.length-1),i),s=new BABYLON.Texture(e,i);this.materials.push(n),this.textures.push(s),t&&(this.materials[this.materials.length-1].opacityTexture=s),this.materials[this.materials.length-1].diffuseTexture=s,this.materials[this.materials.length-1].emissiveColor=new BABYLON.Color3(1,1,1)},e.loadSound=function(e,t){var i=new BABYLON.Sound("snd_"+this.sounds.length,e,t);this.sounds.push(i)},e.textures=new Array,e.materials=new Array,e.sounds=new Array,e}();t.ContentManager=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),s=i(4),r=i(5),o=i(6),a=i(1),_=i(7),p=function(){function e(e){this._left_spikes=new Array,this._right_spikes=new Array,this._top_spikes=new Array,this._bottom_spikes=new Array,this._active_spikes_left=new Array,this._active_spikes_right=new Array,this._moving_spike_indices=new Array,this.LEFT_SPIKES_FRAME_0=-400,this.LEFT_SPIKES_FRAME_1=-333,this.LEFT_SPIKES=0,this.RIGHT_SPIKES=1,this._canvas=document.getElementById(e),this._engine=new BABYLON.Engine(this._canvas,!0),this._scene=new BABYLON.Scene(this._engine),this._gameover=!1,this._player_ready=!1,this._generated_spikes=!1,this._gravity=-1350,this._score=0}return e.prototype.interpolateSpikes=function(e,t){this._interp_t=BABYLON.Scalar.Lerp(e[0].position.x,t,this._interp_speed*this._delta);for(var i=0;i<e.length;i++)e[i].position.x=this._interp_t},e.prototype.toggleSpikes=function(e,t,i,s){if(!this._generated_spikes){if(s)for(a=0;a<t.length;a++)t[a].i_mesh.position.x=i;else{t=[];for(var r=n.generateSpikeIndicesFromLevel(this._score),a=0;a<r.length;a++)t[r[a]]=o.SpikeCopyAssign(e[r[a]]),t[r[a]].i_mesh.position.x=i}this._generated_spikes=!0}},e.prototype.initialise=function(){var e=this;this._scene.gravity=new BABYLON.Vector3(0,-500,0),this._scene.collisionsEnabled=!0,this._scene.enablePhysics(new BABYLON.Vector3(0,this._gravity,0),new BABYLON.AmmoJSPlugin),_.UserInterface.initialise(),a.ContentManager.makeMatFromTexture("./assets/Bird0.png",!0,this._scene),a.ContentManager.textures.push(new BABYLON.Texture("./assets/Bird1.png",this._scene)),a.ContentManager.materials.push(new BABYLON.StandardMaterial("Spike_mat",this._scene)),a.ContentManager.materials[1].emissiveColor=new BABYLON.Color3(1,.63,.66),a.ContentManager.spike=BABYLON.Mesh.CreateDisc("triangle",35,3,this._scene),a.ContentManager.spike.isVisible=!1,a.ContentManager.spike.material=a.ContentManager.materials[1],a.ContentManager.spike.scaling.y=1.1,this._cam=new r.OrthoCamera(new BABYLON.Vector2(0,0),this._scene,this._canvas),this._player=new s.Player(new BABYLON.Vector2(0,0),this._scene,this._canvas),this._player.mesh.material=a.ContentManager.materials[0],a.ContentManager.spike.position.x=this.LEFT_SPIKES_FRAME_0;var t=-170,i=84,n=0;for(n=0;n<5;n++)this._left_spikes.push(new o.Spike(n,new BABYLON.Vector2(0,0),this._scene,this._canvas)),this._left_spikes[this._left_spikes.length-1].i_mesh.position.y=t+n*i,this._active_spikes_left[n]=this._left_spikes[n];for(a.ContentManager.spike.position.x=-this.LEFT_SPIKES_FRAME_0,a.ContentManager.spike.scaling.x=-a.ContentManager.spike.scaling.x,n=0;n<5;n++)this._right_spikes.push(new o.Spike(n,new BABYLON.Vector2(0,0),this._scene,this._canvas)),this._right_spikes[this._right_spikes.length-1].i_mesh.position.y=t+n*i,this._active_spikes_right[n]=this._right_spikes[n];for(a.ContentManager.spike.position.y=284,a.ContentManager.spike.rotate(new BABYLON.Vector3(0,0,1),BABYLON.Tools.ToRadians(90),BABYLON.Space.LOCAL),t=-382,i=76,n=0;n<10;n++)this._top_spikes.push(new o.Spike(n,new BABYLON.Vector2(0,0),this._scene,this._canvas)),this._top_spikes[this._top_spikes.length-1].i_mesh.position.x=t+n*i;for(a.ContentManager.spike.position.y=-284,a.ContentManager.spike.rotate(new BABYLON.Vector3(0,0,1),BABYLON.Tools.ToRadians(180),BABYLON.Space.LOCAL),n=0;n<10;n++)this._top_spikes.push(new o.Spike(n,new BABYLON.Vector2(0,0),this._scene,this._canvas)),this._top_spikes[this._top_spikes.length-1].i_mesh.position.x=t+n*i;var p=function(){if(e._delta=e._engine.getDeltaTime(),e._player_ready)if(e._player.mesh.position.x+=e._player.speed*e._delta*e._player.currentDir,e._gameover)e._gameover&&(e._player.mesh.rotate(new BABYLON.Vector3(0,0,1),BABYLON.Tools.ToRadians(6),BABYLON.Space.LOCAL),a.ContentManager.materials[0].alpha-=.001*e._delta,e._player.mesh.position.y<-1e3&&(e._score>0&&e.interpolateSpikes(e._active_spikes_left,e.LEFT_SPIKES_FRAME_0),e.interpolateSpikes(e._active_spikes_right,-e.LEFT_SPIKES_FRAME_0),e._active_spikes_left[0].i_mesh.position.x<=e.LEFT_SPIKES_FRAME_0+4&&e._active_spikes_right[0].i_mesh.position.x>=-e.LEFT_SPIKES_FRAME_0-4&&(e._scene.getPhysicsEngine().removeImpostor(e._player.mesh.physicsImpostor),e._player.mesh.position=BABYLON.Vector3.Zero(),e._player.mesh.rotationQuaternion.copyFromFloats(0,0,0,1),e._player.mesh.scaling.x=Math.abs(e._player.mesh.scaling.x),a.ContentManager.materials[0].diffuseTexture=a.ContentManager.textures[0],e._score=0,e._player.currentDir=s.Player.DIR_LEFT,e._player_ready=!1,e._gameover=!1)));else if((e._player.mesh.position.y+e._player.height/2>250||e._player.mesh.position.y-e._player.height/2<-250)&&(e._gameover=!0),e._player.currentDir==s.Player.DIR_LEFT){e._player.mesh.position.x>=296&&(e._player.currentDir=s.Player.DIR_RIGHT,e._generated_spikes=!1,e._score++,_.UserInterface.textblock.text=""+e._score,e._player.mesh.scaling.x=-e._player.mesh.scaling.x,e.toggleSpikes(e._left_spikes,e._active_spikes_left,e.LEFT_SPIKES_FRAME_1,!1),e.toggleSpikes(e._right_spikes,e._active_spikes_right,e.LEFT_SPIKES_FRAME_0,!0));for(var t=0;t<e._active_spikes_right.length;t++)e._active_spikes_right[t]&&e._player.mesh.intersectsMesh(e._active_spikes_right[t].i_mesh)&&(e._gameover=!0)}else{e._player.mesh.position.x<=-296&&(e._player.currentDir=s.Player.DIR_LEFT,e._generated_spikes=!1,e._score++,_.UserInterface.textblock.text=""+e._score,e._player.mesh.scaling.x=-e._player.mesh.scaling.x,e._score>0&&e.toggleSpikes(e._right_spikes,e._active_spikes_right,-e.LEFT_SPIKES_FRAME_1,!1));for(t=0;t<e._active_spikes_left.length;t++)e._active_spikes_left[t]&&e._player.mesh.intersectsMesh(e._active_spikes_left[t].i_mesh)&&(e._gameover=!0)}e._player.speed+=1e-6*e._delta};this._canvas.addEventListener("keydown",(function(t){if(!e._gameover)switch(t.keyCode){case 32:a.ContentManager.materials[0].alpha>=.9&&(a.ContentManager.materials[0].alpha=1,a.ContentManager.materials[0].diffuseTexture=a.ContentManager.textures[1],e._player_ready||(e._player.mesh.physicsImpostor=new BABYLON.PhysicsImpostor(e._player.mesh,BABYLON.PhysicsImpostor.SphereImpostor,{mass:1,restitution:.9},e._scene),e._player.speed=.225,_.UserInterface.textblock.text="0",e.toggleSpikes(e._right_spikes,e._active_spikes_right,-e.LEFT_SPIKES_FRAME_1,!1),e._generated_spikes=!1,e._player_ready=!0),e._player.mesh.physicsImpostor.setLinearVelocity(new BABYLON.Vector3(0,1,0)),e._player.mesh.applyImpulse(new BABYLON.Vector3(0,400,0),e._player.mesh.getAbsolutePosition().add(BABYLON.Vector3.Zero())))}}),!1),this._canvas.addEventListener("keyup",(function(t){if(!e._gameover)switch(t.keyCode){case 32:a.ContentManager.materials[0].diffuseTexture=a.ContentManager.textures[0]}}),!1),this._scene.registerBeforeRender((function(){p()}))},e.prototype.playLoop=function(){var e=this,t=this;this._engine.runRenderLoop((function(){e._scene.clearColor=new BABYLON.Color4(1,.94,.96,1),t._scene.render()})),window.addEventListener("resize",(function(){t._engine.resize()}))},e}();window.addEventListener("DOMContentLoaded",(function(){var e=new p("renderCanvas");e.initialise(),e.playLoop()}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateSpikeIndicesFromLevel=function(e){for(var t=[],i=(function(e){var t=Math.random()*BABYLON.Scalar.RandomRange(e*Math.floor(Math.pow(.25,2)),4)+4;t>4&&BABYLON.Scalar.RandomRange(3,4)}(e),0);i<2;i++)t[i]=Math.floor(4*Math.random());return t}},function(e,t,i){"use strict";var n,s=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n){var s=e.call(this,t)||this;return s.width=60,s.height=98,s.currentDir=1,s.mesh=BABYLON.MeshBuilder.CreatePlane("player",{height:s.width,width:s.height},i),s.mesh.position=new BABYLON.Vector3(0,0,0),s.mesh.checkCollisions=!0,s}return s(t,e),t.prototype.updateSpikeCollision=function(e){for(var t=0;t<e.length;t++)this.mesh.intersectsMesh(e[t].i_mesh)&&(this.hitSpike=!0)},t.prototype.update=function(e){},t.DIR_LEFT=1,t.DIR_RIGHT=-1,t}(i(0).Entity);t.Player=r},function(e,t,i){"use strict";var n,s=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i,n){var s=e.call(this,t)||this;s.camObj=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,0,-10),i),s.camObj.inputs.clear(),s.camObj.mode=BABYLON.Camera.ORTHOGRAPHIC_CAMERA;var r=window.innerWidth/window.innerHeight,o=s.camObj.orthoTop,a=o*r;return s.camObj.orthoTop=a,s.camObj.orthoLeft=-Math.abs(o),s.camObj.orthoRight=a,s.camObj.orthoBottom=-Math.abs(o),s.camObj.attachControl(n,!0),s}return s(t,e),t.prototype.update=function(e){},t}(i(0).Entity);t.OrthoCamera=r},function(e,t,i){"use strict";var n,s=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),o=i(1);t.SpikeCopyAssign=function(e){var t=e;return t.active=e.active,t.instance_id=e.instance_id,t.position=e.position,t.i_mesh=e.i_mesh,t};var a=function(e){function t(t,i,n,s){var r=e.call(this,i)||this;return r.instance_id=t,r.i_mesh=o.ContentManager.spike.createInstance("instance_"+t),r.position=i,r}return s(t,e),t.prototype.update=function(e){},t}(r.Entity);t.Spike=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.initialise=function(){var e=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI"),t=new BABYLON.GUI.StackPanel;e.addControl(t),t.top="-180px",this.textblock=new BABYLON.GUI.TextBlock("textblock","0"),this.textblock.width=.4,this.textblock.height="60px",this.textblock.color="white",this.textblock.fontSize="30px",this.textblock.color="rgb(255, 163, 165)",this.textblock.fontFamily="Helvetica",this.textblock.text="0",t.addControl(this.textblock)},e}();t.UserInterface=n}]);